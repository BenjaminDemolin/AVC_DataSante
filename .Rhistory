print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
ggplot(hypertension, aes(x = Hypertension, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Hypertension en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
maladie_cardiaque <- as.data.frame(table(data_format$heart_disease, data_format$stroke))
colnames(maladie_cardiaque) <- c('Maladie_cardiaque','AVC','Fréquence')
head(maladie_cardiaque)
maladie_cardiaque0 <- (maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==0 & maladie_cardiaque$AVC == 1] / maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==0 & maladie_cardiaque$AVC == 0])*100
maladie_cardiaque1 <- (maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==1 & maladie_cardiaque$AVC == 1] / maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==1 & maladie_cardiaque$AVC == 0])*100
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
ggplot(maladie_cardiaque, aes(x = Maladie_cardiaque, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Maladie cardiaque en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
mariage <- as.data.frame(table(data_format$ever_married, data_format$stroke))
colnames(mariage) <- c('Mariage','AVC','Fréquence')
head(mariage)
mariage_no <- (mariage$Fréquence[mariage$Mariage =="No" & mariage$AVC == 1] / mariage$Fréquence[mariage$Mariage =="No" & mariage$AVC == 0])*100
mariage_yes <- (mariage$Fréquence[mariage$Mariage =="Yes" & mariage$AVC == 1] / mariage$Fréquence[mariage$Mariage =="Yes" & mariage$AVC == 0])*100
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
ggplot(mariage, aes(x = Mariage, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Ayant eu un mariage en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
type_travail <- as.data.frame(table(data_format$work_type, data_format$stroke))
colnames(type_travail) <- c('Type_travail','AVC','Fréquence')
head(type_travail)
enfant_avc <- (type_travail$Fréquence[type_travail$Type_travail =="children" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="children" & type_travail$AVC == 0])*100
gouvernement_job_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Govt_job" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Govt_job" & type_travail$AVC == 0])*100
pas_travail_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Never_worked" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Never_worked" & type_travail$AVC == 0])*100
prive_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Private" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Private" & type_travail$AVC == 0])*100
independant_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Self-employed" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Self-employed" & type_travail$AVC == 0])*100
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
ggplot(type_travail, aes(x = Type_travail, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Type de travail en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
type_residence <- as.data.frame(table(data_format$Residence_type, data_format$stroke))
colnames(type_residence) <- c('Type_residence','AVC','Fréquence')
head(type_residence)
femme_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
homme_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
ggplot(type_residence, aes(x = Type_residence, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Type de résidence en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
min(avc0$avg_glucose_level)
max(avc0$avg_glucose_level)
min(avc1$avg_glucose_level)
max(avc1$avg_glucose_level)
ggplot(avc0, aes(x=avg_glucose_level)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(55, 275, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des niveaux de glucose des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(avc1, aes(x=avg_glucose_level)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(55, 275, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des niveaux de glucose des AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=avg_glucose_level, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(55, 275, by = 10) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des niveaux de glucose en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=stroke, y=avg_glucose_level, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des niveaux de glucose en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
```
```{r}
min(avc0$bmi)
max(avc0$bmi)
min(avc1$bmi)
max(avc1$bmi)
ggplot(avc0, aes(x=bmi)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(10, 100, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des IMC des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(avc1, aes(x=bmi)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(10, 100, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des IMC des AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=bmi, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(10, 100, by = 10) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des IMC en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=stroke, y=bmi, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des IMC en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
```
```{r}
fumeur <- as.data.frame(table(data_format$smoking_status, data_format$stroke))
colnames(fumeur) <- c('Status_fumeur','AVC','Fréquence')
head(fumeur)
femme_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
homme_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
ggplot(fumeur, aes(x = Status_fumeur, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Status fumeur en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
avc <- as.data.frame(table( data_format$stroke))
colnames(avc) <- c('AVC','Fréquence')
head(avc)
femme_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
homme_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
ggplot(avc, aes(x = AVC, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Nombre d'AVC du jeu de donnée") + theme(plot.title = element_text(hjust = 0.5), legend.position="none")+
geom_text(aes(label = Fréquence), vjust = 0)
```
```{r}
data_cor<- data_format[,-c(1,5,6,7,10)]
data_cor$stroke <- as.numeric(as.character(data_cor$stroke))
str(data_cor)
M<-cor(data_cor)
corrplot(M, method="circle")
corrplot(M, method="color")
corrplot(M, method="number")
```
```{r}
ggplot(data_format, aes(x = age, y = bmi, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = hypertension, y = age, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = heart_disease, y = age , colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = age, y = avg_glucose_level, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction du niveau de glucose et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = stroke, y = age , colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
```
```{r}
```
type_residence <- as.data.frame(table(data_format$Residence_type, data_format$stroke))
colnames(type_residence) <- c('Type_residence','AVC','Fréquence')
head(type_residence)
rural_avc <- (type_residence$Fréquence[type_residence$Type_residence =="Rural" & type_residence$AVC == 1] / type_residence$Fréquence[type_residence$Type_residence =="Rural" & type_residence$AVC == 0])*100
urbain_avc <- (type_residence$Fréquence[type_residence$Type_residence =="Urban" & type_residence$AVC == 1] / type_residence$Fréquence[type_residence$Type_residence =="Urban" & type_residence$AVC == 0])*100
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
ggplot(type_residence, aes(x = Type_residence, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Type de résidence en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
library(ggplot2)
library(corrplot)
data <- read.csv("healthcare-dataset-stroke-data.csv", header=TRUE, sep=",")
head(data)
str(data)
data_format <- data
str(data_format)
nrow(data_format)
# supprime id
data_format<- data_format[,-c(1)]
# conversion de bmi chr en num
data_format$bmi <- suppressWarnings(as.numeric(data_format$bmi))
# supprime le cas ou genre = other (une fois)
data_format<-data_format[!(data_format$gender=="Other"),]
data_format<-data_format[!(data_format$smoking_status=="Unknown"),]
# conversion chr en facteur
data_format <- as.data.frame(unclass(data_format), stringsAsFactors = TRUE)
# supprime les na
data_format <- na.omit(data_format)
# stroke en facteur
data_format$stroke <- as.factor(data_format$stroke)
str(data_format)
nrow(data_format)
avc0 <- subset(data_format, stroke == 0)
avc1 <- subset(data_format, stroke == 1)
ggplot(avc0, aes(x=age)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(0, 85, by = 5) )+
geom_density(col = 2) +
ggtitle("Histogramme des âges des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(avc1, aes(x=age)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(0, 85, by = 5) )+
geom_density(col = 2) +
ggtitle("Histogramme des âges des AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=age, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(0, 85, by = 5) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des âges en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=stroke, y=age, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des âges en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
gender <- as.data.frame(table(data_format$gender, data_format$stroke))
colnames(gender) <- c('Genre','AVC','Fréquence')
head(gender)
femme_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
homme_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
ggplot(gender, aes(x = Genre, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Genre en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
gender <- as.data.frame(table(data_format$gender, data_format$stroke))
colnames(gender) <- c('Genre','AVC','Fréquence')
head(gender)
femme_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
homme_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
ggplot(gender, aes(x = Genre, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Genre en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
hypertension <- as.data.frame(table(data_format$hypertension, data_format$stroke))
colnames(hypertension) <- c('Hypertension','AVC','Fréquence')
head(hypertension)
hypertention0_avc <- (hypertension$Fréquence[hypertension$Hypertension ==0 & hypertension$AVC == 1] / hypertension$Fréquence[hypertension$Hypertension ==0 & hypertension$AVC == 0])*100
hypertention1_avc <- (hypertension$Fréquence[hypertension$Hypertension ==1 & hypertension$AVC == 1] / hypertension$Fréquence[hypertension$Hypertension ==1 & hypertension$AVC == 0])*100
print(paste("Pourcentage de hypertension 0 AVC : " ,round(hypertention0_avc,2),"%"))
print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
ggplot(hypertension, aes(x = Hypertension, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Hypertension en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
maladie_cardiaque <- as.data.frame(table(data_format$heart_disease, data_format$stroke))
colnames(maladie_cardiaque) <- c('Maladie_cardiaque','AVC','Fréquence')
head(maladie_cardiaque)
maladie_cardiaque0 <- (maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==0 & maladie_cardiaque$AVC == 1] / maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==0 & maladie_cardiaque$AVC == 0])*100
maladie_cardiaque1 <- (maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==1 & maladie_cardiaque$AVC == 1] / maladie_cardiaque$Fréquence[maladie_cardiaque$Maladie_cardiaque ==1 & maladie_cardiaque$AVC == 0])*100
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
ggplot(maladie_cardiaque, aes(x = Maladie_cardiaque, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Maladie cardiaque en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
mariage <- as.data.frame(table(data_format$ever_married, data_format$stroke))
colnames(mariage) <- c('Mariage','AVC','Fréquence')
head(mariage)
mariage_no <- (mariage$Fréquence[mariage$Mariage =="No" & mariage$AVC == 1] / mariage$Fréquence[mariage$Mariage =="No" & mariage$AVC == 0])*100
mariage_yes <- (mariage$Fréquence[mariage$Mariage =="Yes" & mariage$AVC == 1] / mariage$Fréquence[mariage$Mariage =="Yes" & mariage$AVC == 0])*100
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
ggplot(mariage, aes(x = Mariage, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Ayant eu un mariage en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
type_travail <- as.data.frame(table(data_format$work_type, data_format$stroke))
colnames(type_travail) <- c('Type_travail','AVC','Fréquence')
head(type_travail)
enfant_avc <- (type_travail$Fréquence[type_travail$Type_travail =="children" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="children" & type_travail$AVC == 0])*100
gouvernement_job_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Govt_job" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Govt_job" & type_travail$AVC == 0])*100
pas_travail_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Never_worked" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Never_worked" & type_travail$AVC == 0])*100
prive_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Private" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Private" & type_travail$AVC == 0])*100
independant_avc <- (type_travail$Fréquence[type_travail$Type_travail =="Self-employed" & type_travail$AVC == 1] / type_travail$Fréquence[type_travail$Type_travail =="Self-employed" & type_travail$AVC == 0])*100
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
ggplot(type_travail, aes(x = Type_travail, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Type de travail en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
type_residence <- as.data.frame(table(data_format$Residence_type, data_format$stroke))
colnames(type_residence) <- c('Type_residence','AVC','Fréquence')
head(type_residence)
rural_avc <- (type_residence$Fréquence[type_residence$Type_residence =="Rural" & type_residence$AVC == 1] / type_residence$Fréquence[type_residence$Type_residence =="Rural" & type_residence$AVC == 0])*100
urbain_avc <- (type_residence$Fréquence[type_residence$Type_residence =="Urban" & type_residence$AVC == 1] / type_residence$Fréquence[type_residence$Type_residence =="Urban" & type_residence$AVC == 0])*100
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
ggplot(type_residence, aes(x = Type_residence, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Type de résidence en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
min(avc0$avg_glucose_level)
max(avc0$avg_glucose_level)
min(avc1$avg_glucose_level)
max(avc1$avg_glucose_level)
ggplot(avc0, aes(x=avg_glucose_level)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(55, 275, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des niveaux de glucose des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(avc1, aes(x=avg_glucose_level)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(55, 275, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des niveaux de glucose des AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=avg_glucose_level, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(55, 275, by = 10) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des niveaux de glucose en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=stroke, y=avg_glucose_level, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des niveaux de glucose en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
min(avc0$bmi)
max(avc0$bmi)
min(avc1$bmi)
max(avc1$bmi)
ggplot(avc0, aes(x=bmi)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(10, 100, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des IMC des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(avc1, aes(x=bmi)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(10, 100, by = 10) )+
geom_density(col = 2) +
ggtitle("Histogramme des IMC des AVCs") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=bmi, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(10, 100, by = 10) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des IMC en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x=stroke, y=bmi, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des IMC en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
fumeur <- as.data.frame(table(data_format$smoking_status, data_format$stroke))
colnames(fumeur) <- c('Status_fumeur','AVC','Fréquence')
head(fumeur)
test_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
test_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(test_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(test_avc,2),"%"))
ggplot(fumeur, aes(x = Status_fumeur, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Status fumeur en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
fumeur <- as.data.frame(table(data_format$smoking_status, data_format$stroke))
colnames(fumeur) <- c('Status_fumeur','AVC','Fréquence')
head(fumeur)
ancien_fumeur_avc <- (fumeur$Fréquence[fumeur$Status_fumeur =="formerly smoked" & fumeur$AVC == 1] / fumeur$Fréquence[fumeur$Status_fumeur =="formerly smoked" & fumeur$AVC == 0])*100
non_fumeur_avc <- (fumeur$Fréquence[fumeur$Status_fumeur =="never smoked" & fumeur$AVC == 1] / fumeur$Fréquence[fumeur$Status_fumeur =="never smoked" & fumeur$AVC == 0])*100
fumeur_avc <- (fumeur$Fréquence[fumeur$Status_fumeur =="smokes" & fumeur$AVC == 1] / fumeur$Fréquence[fumeur$Status_fumeur =="smokes" & fumeur$AVC == 0])*100
print(paste("Pourcentage de ancien fumeur AVC : " ,round(ancien_fumeur_avc,2),"%"))
print(paste("Pourcentage de non fumeur AVC : " ,round(non_fumeur_avc,2),"%"))
print(paste("Pourcentage de fumeur AVC : " ,round(fumeur_avc,2),"%"))
ggplot(fumeur, aes(x = Status_fumeur, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Status fumeur en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))+
geom_text(aes(label = Fréquence), vjust = 0)
avc <- as.data.frame(table( data_format$stroke))
colnames(avc) <- c('AVC','Fréquence')
head(avc)
test_avc <- (gender$Fréquence[gender$Genre =="Female" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Female" & gender$AVC == 0])*100
test_avc <- (gender$Fréquence[gender$Genre =="Male" & gender$AVC == 1] / gender$Fréquence[gender$Genre =="Male" & gender$AVC == 0])*100
print(paste("Pourcentage de femme AVC : " ,round(test_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(test_avc,2),"%"))
ggplot(avc, aes(x = AVC, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Nombre d'AVC du jeu de donnée") + theme(plot.title = element_text(hjust = 0.5), legend.position="none")+
geom_text(aes(label = Fréquence), vjust = 0)
data_cor<- data_format[,-c(1,5,6,7,10)]
data_cor$stroke <- as.numeric(as.character(data_cor$stroke))
str(data_cor)
M<-cor(data_cor)
corrplot(M, method="circle")
corrplot(M, method="color")
corrplot(M, method="number")
ggplot(data_format, aes(x = age, y = bmi, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = hypertension, y = age, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = heart_disease, y = age , colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction de l'IMC et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = age, y = avg_glucose_level, colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction du niveau de glucose et des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
ggplot(data_format, aes(x = stroke, y = age , colour = stroke)) +
geom_point(alpha=0.5)+
ggtitle("Age en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
avc <- as.data.frame(table( data_format$stroke))
colnames(avc) <- c('AVC','Fréquence')
head(avc)
ggplot(avc, aes(x = AVC, y = Fréquence, fill = AVC)) +
geom_bar(stat = "identity") +
ggtitle("Nombre d'AVC du jeu de donnée") + theme(plot.title = element_text(hjust = 0.5), legend.position="none")+
geom_text(aes(label = Fréquence), vjust = 0)
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
print(paste("--------------- " ))
print(paste("Pourcentage de hypertension 0 AVC : " ,round(hypertention0_avc,2),"%"))
print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
print(paste("Pourcentage de ancien fumeur AVC : " ,round(ancien_fumeur_avc,2),"%"))
print(paste("Pourcentage de non fumeur AVC : " ,round(non_fumeur_avc,2),"%"))
print(paste("Pourcentage de fumeur AVC : " ,round(fumeur_avc,2),"%"))
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de hypertension 0 AVC : " ,round(hypertention0_avc,2),"%"))
print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de ancien fumeur AVC : " ,round(ancien_fumeur_avc,2),"%"))
print(paste("Pourcentage de non fumeur AVC : " ,round(non_fumeur_avc,2),"%"))
print(paste("Pourcentage de fumeur AVC : " ,round(fumeur_avc,2),"%"))
print(paste("----------------------------------------------Genre------------------------------------------------- " ))
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de hypertension 0 AVC : " ,round(hypertention0_avc,2),"%"))
print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
print(paste("----------------------------------------------------------------------------------------------- " ))
print(paste("Pourcentage de ancien fumeur AVC : " ,round(ancien_fumeur_avc,2),"%"))
print(paste("Pourcentage de non fumeur AVC : " ,round(non_fumeur_avc,2),"%"))
print(paste("Pourcentage de fumeur AVC : " ,round(fumeur_avc,2),"%"))
print(paste("----------------------------------------------Genre------------------------------------------------- " ))
print(paste("Pourcentage de femme AVC : " ,round(femme_avc,2),"%"))
print(paste("Pourcentage de homme AVC : " ,round(homme_avc,2),"%"))
print(paste("----------------------------------------------Hypertension------------------------------------------------- " ))
print(paste("Pourcentage de hypertension 0 AVC : " ,round(hypertention0_avc,2),"%"))
print(paste("Pourcentage de hypertension 1 AVC : " ,round(hypertention1_avc,2),"%"))
print(paste("----------------------------------------------Maladie cardiaque------------------------------------------------- " ))
print(paste("Pourcentage de maladie cardiage 0 AVC : " ,round(maladie_cardiaque0,2),"%"))
print(paste("Pourcentage de maladie cardiage 1 AVC : " ,round(maladie_cardiaque1,2),"%"))
print(paste("----------------------------------------------Mariage------------------------------------------------- " ))
print(paste("Pourcentage de pas marié AVC : " ,round(mariage_no,2),"%"))
print(paste("Pourcentage de marié AVC : " ,round(mariage_yes,2),"%"))
print(paste("----------------------------------------------Type Job------------------------------------------------- " ))
print(paste("Pourcentage de enfant AVC : " ,round(enfant_avc,2),"%"))
print(paste("Pourcentage de job gouvernement AVC : " ,round(gouvernement_job_avc,2),"%"))
print(paste("Pourcentage de pas de travail AVC : " ,round(pas_travail_avc,2),"%"))
print(paste("Pourcentage de job privé AVC : " ,round(prive_avc,2),"%"))
print(paste("Pourcentage de indépendant AVC : " ,round(independant_avc,2),"%"))
print(paste("----------------------------------------------Type résidence------------------------------------------------- " ))
print(paste("Pourcentage de rural AVC : " ,round(rural_avc,2),"%"))
print(paste("Pourcentage de urbain AVC : " ,round(urbain_avc),"%"))
print(paste("----------------------------------------------Status fumeur------------------------------------------------- " ))
print(paste("Pourcentage de ancien fumeur AVC : " ,round(ancien_fumeur_avc,2),"%"))
print(paste("Pourcentage de non fumeur AVC : " ,round(non_fumeur_avc,2),"%"))
print(paste("Pourcentage de fumeur AVC : " ,round(fumeur_avc,2),"%"))
# Variable - Age
# Cree un data set avec AVc = 0 et un autre = 1
avc0 <- subset(data_format, stroke == 0)
avc1 <- subset(data_format, stroke == 1)
# Plot hist age avc = 0
ggplot(avc0, aes(x=age)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(0, 85, by = 5) )+
geom_density(col = 2) +
ggtitle("Histogramme des âges des non AVCs") + theme(plot.title = element_text(hjust = 0.5))
# Plot hist age avc = 1
ggplot(avc1, aes(x=age)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2,col="#00AFBB", fill="#00AFBB", breaks=seq(0, 85, by = 5) )+
geom_density(col = 2) +
ggtitle("Histogramme des âges des AVCs") + theme(plot.title = element_text(hjust = 0.5))
# Plot hist et densité age avc
ggplot(data_format, aes(x=age, color =stroke, fill = stroke)) +
geom_histogram(aes(y =..density..),position="identity", alpha=0.2, breaks=seq(0, 85, by = 5) )+
geom_density(alpha=0.2) +
ggtitle("Histogramme des âges en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
# boxPlot age
ggplot(data_format, aes(x=stroke, y=age, color=stroke)) +
geom_boxplot() +
ggtitle("Boxplot des âges en fonction des chances de faire un AVC") + theme(plot.title = element_text(hjust = 0.5))
